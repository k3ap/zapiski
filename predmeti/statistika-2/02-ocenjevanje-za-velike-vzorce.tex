\naslov{Ocenjevanje za velike vzorce}

Naj bodo $X, X_1, X_2, \ldots$ slučajni vektorji, definirani na nekem skupnem
verjetnostnem prostoru.
\begin{itemize}
\item $(X_n)_n$ konvergira k $X$ \pojem{skoraj gotovo}, če je $P(\lim X_n = X) =
  1$.
\item $(X_n)_n$ konvergira k $X$ \pojem{v verjetnosti}, če za vsak $\varepsilon
  > 0$ velja $\lim P(\norm{X_n - X} > \varepsilon) = 0$.
\item $(X_n)_n$ konvergira k $X$ \pojem{v $L^2$}, če je $\lim E(\norm{X_n -
	X}_2^2) = 0$ ($\norm{\cdot}_2$ je funkcijska norma).
\item $(X_n)_n$ konvergira k $X$ \pojem{v porazdelitvi}, če velja $\lim
  F_{X_n}(x) = F_X(x)$ za vsako točko $x$, v kateri je $F_X$ zvezna.
\end{itemize}

\begin{lema}
  Naj bodo $X, X_1, X_2, \ldots$ slučajni $r$-vektorji.
  Potem velja naslednje.
  \begin{itemize}
  \item $X_n$ konvergira k $X$ v verjetnosti natanko tedaj, ko ima vsako
	podzaporedje zaporedja $(X_n)_n$ nadaljnje podzaporedje, ki konvergira
	skoraj gotovo.
  \item $X_n$ konvergira k $X$ v porazdelitvi natanko tedaj, ko za vsak $\xi \in
	\R^r$ velja $\sk{X_n, \xi} \xrightarrow{d} \sk{X, \xi}$.
  \end{itemize}
\end{lema}

\begin{trditev}
  Z enakimi oznakami, če $X_n$ konvergira k $X$ skoraj gotovo ali v $L^2$
  smislu, potem konvergira tudi v verjetnosti.
  Če konvergira v verjetnosti, potem konvergira tudi v porazdelitvi.
  Če je $X$ konstanten vektor, potem sta konvergenca v porazdelitvi in v
  verjetnosti ekvivalentni.
\end{trditev}

\begin{trditev}
  Naj bodo $X, X_1, X_2, \ldots$ slučajni $r$-vektorji in naj bo $g: \R^r \to
  \R^s$ Borelova funkcija, ki je zvezna skoraj povsod glede na $P_X$.
  Potem, če $X_n$ konvergira k $X$ skoraj gotovo, ali v verjetnosti, ali v
  porazdelitvi, potem tudi $g(X_n)$ konvergira k $g(X)$ v enakem smislu.
\end{trditev}

\begin{trditev}[Slucki]
  Naj bodo $X, X_1, X_2, \ldots$ in $Y_1, Y_2, \ldots$ slučajne spremenljivke.
  Dalje naj bo $c \in \R$.
  Privzemimo $X_n \xrightarrow{d} c$ in $Y_n \xrightarrow{d} c$.
  Tedaj $X_n + Y_n \xrightarrow{d} X+c$, $X_n Y_n \xrightarrow{d} cX$ in, če $c
  \ne 0$, $X_n / Y_n \xrightarrow{d} X/c$.
\end{trditev}

\begin{remark}
  Trditev lahko posplošimo na slučajne vektorje.
\end{remark}

\begin{primer}
  Naj bodo $X_1, X_2, \ldots$ neodvisne enako porazdeljene slučajne
  spremenljivke z disperzijo $\sigma^2$ in pričakovano vrednostjo $\mu$.
  Po centralnem limitnem izreku velja
  \[
	\frac{\cl{X} - \mu}{\sigma / \sqrt{n}} \xrightarrow[n \to \infty]{d} N(0,1).
  \]
  Potem po krepkem zakonu velikih števil
  \[
	\left(
	  \inv{n} \sum_i X_i,
	  \inv{n} \sum_i X_i^2
	\right)
	\xrightarrow[n \to \infty]{s.g.}
	(\mu, \sigma^2 + \mu^2).
  \]
  Upoštevaje zveznost potem velja
  \[
	S^2 = \frac{n}{n-1} \left( \inv{n} \sum_i X_i^2 - \cl{X}^2 \right)
	\xrightarrow[n \to \infty]{s.g.}
	\sigma^2
  \]
  za
  \[
	S := \sqrt{\inv{n-1} \sum_i (X_i - \cl{X})^2}.
  \]
  Po izreku Sluckega je potem
  \[
	\frac{\cl{X} - \mu}{S / \sqrt{n}} \xrightarrow[n \to \infty]{d} N(0,1).
  \]
\end{primer}

\begin{trditev}
  Naj bodo $Y, X_1, X_2, \ldots$ slučajni $r$-vektorji, $c \in \R^r$ ter
  $(a_n)_n$ zaporedje pozitivnih realnih števil z $a_n \to \infty$.
  Naj bo $g: \R^r \to \R$ Borelova funkcija, diferenciabilna pri $c$.
  Če velja
  \[
	a_n (X_n - c) \xrightarrow[n \to \infty]{d} Y
  \]
  in $dg(c) \ne 0$, potem velja tudi
  \[
	a_n (g(X_n) - g(c)) \xrightarrow[n \to \infty]{d} \sk{\grad g(c), Y} Y.
  \]
\end{trditev}

\begin{proof}
  Spomnimo se:
  Za vsak $\varepsilon > 0$ obstaja $\delta > 0$, da iz $\norm{x -c} \le \delta$
  sledi
  \[
	\abs{g(x) - g(c) - dg(c)(x-c)} \le \varepsilon \norm{x-c}.
  \]
  Izberimo neki $\varepsilon > 0$ in mu pridružimo $\delta$.
  Pišimo $Z_n = a_n (g(X_n) - g(X)) - a_n dg(c) (X_n - c)$.
  Pokazali bomo $Z_n \xrightarrow{p} 0$.
  Ko to vemo, lahko $Z_n$ prištejemo $a_n dg(c) (X_n - c)$ in bo rezultat
  sledil.

  Pokažimo, da za poljuben $\eta > 0$ velja $\lim P(\abs{Z_n} > \eta) = 0$.
  Velja
  \begin{align*}
	P(\abs{Z_n} > \eta)
	&= P(\abs{Z_n} > \eta \land \norm{X_n - c} > \delta)
	+ P(\abs{Z_n} > \eta \land \norm{X_n - c} \le \delta) \\
	&\le P(\norm{X_n - c} > \delta) + P(\abs{Z_n} > \eta
	  \land \abs{Z_n} \le a_n \varepsilon \norm{X_n - c}) \\
	&\le P(\norm{X_n - c} > \delta) + P(a_n \varepsilon \norm{X_n - c} > \eta).
  \end{align*}
  Ker $a_n^{-1} \to 0$ in $a_n (X_n - c) \xrightarrow{d} Y$, po Sluckem velja
  $X_n - c \xrightarrow{d} 0$.
  Sledi $P(\norm{X_n - c} > \delta) \xrightarrow{p} 0$.
  Ker je norma zvezna, velja tudi $\norm{a_n (X_n - c)} \xrightarrow{d}
  \norm{Y}$, zato
  \[
	\limsup P(\abs{Z_n} > \eta)
	\le 0 + \limsup P(\norm{a_n (X_n -c)} > \eta / \varepsilon).
  \]
  To je enako $1 - F_{\norm{Y}}(\eta / \varepsilon)$, če je $F_{\norm{Y}}$
  zvezna v točki $\eta / \varepsilon$.

  Točk nezveznosti je lahko največ števno mnogo.
  Izberemo lahko torej tako zaporedje $(\varepsilon_i)_i$, ki pada proti $0$, za
  katero je $\eta / \varepsilon_i$ točka zveznosti $F_{\norm{Y}}$.
  Za vsak $\varepsilon_i$ potem velja
  \[
	\limsup P(\abs{Z_n} > \eta) \le P(\norm{Y} > \eta / \varepsilon_i)
	\xrightarrow[i \to \infty]{} 0.
  \]
  Torej limita $\lim P(\abs{Z_n} > \eta)$ obstaja in je enaka $0$.
\end{proof}

\begin{posledica}[metoda $\delta$]
  Z enakimi oznakami, če $a_n (X_n - c) \xrightarrow[n \to \infty]{d} N(0,
  \Sigma)$,
  potem $a_n(g(X_n) - g(c)) \xrightarrow[n \to \infty]{d} N(0, dg(c) \Sigma
  dg(c)^T)$.
\end{posledica}

\begin{izrek}[krepki zakon velikih števil]
  Naj bodo $X_1, X_2, \ldots$ neodvisni enako porazdeljeni slučajni
  vektorji s pričakovano vrednostjo $\mu \in \R^r$.
  Potem
  \[
	\inv{n} \sum_i X_i \xrightarrow[n \to \infty]{s.g.} \mu.
  \]
\end{izrek}

\begin{izrek}[centralni limitni izrek]
  Naj bodo $X_1, X_2, \ldots$ neodvisni enako porazdeljeni slučajni vektorji z
  variančno matriko $\Sigma > 0$ ter pričakovano vrednostjo $\mu \in \R^r$.
  Tedaj
  \[
	\sqrt{n} \left( \inv{n} \sum_i X_i - \mu \right)
	\xrightarrow[n \to \infty]{d}
	N(0, \Sigma).
  \]
\end{izrek}

\podnaslov{Doslednost}

Naj bodo $X_1, X_2, \ldots$ neodvisne replikacije slučajne spremenljivke $\Omega
\to \R$.
Spomnimo se, da tako zaporedje $X_i$ lahko modeliramo na $S = \Omega^\N$ s
predpisom $X_i(s) = X(\omega_i)$ za $s = (\omega_n)_n$.
Seveda je $P$ na $S$ definirana s predpisom
\[
  P(A_1 \times A_2 \times \cdots \times A_k \times \Omega \times \Omega \times
  \cdots)
  = P(A_1) \cdots P(A_k).
\]
Porazdelitev $X_i$ pripada privzetemu modelu dopustnih (enorazsežnih)
porazdelitev $\mathcal{P}$.
Naj bo $e: \mathcal{P} \to \R^r$ ocenjevana funkcija.
Zaporedje cenilk $T_n: \R^n \to \R^r$ je za $e$
\begin{itemize}
\item \pojem{krepko dosledno}, če $T_n(X_1, \ldots, X_n) \xrightarrow{s.g.}
  e(P_X)$,
\item \pojem{šibko dosledno}, če $T_n(X_1, \ldots, X_n) \xrightarrow{p} e(P_X)$,
\item \pojem{$L^2$-dosledno} ali \pojem{SKN-dosledno}, če $E(\norm{T_n(X_1,
	\ldots, X_n) - e(P_x)}^2) \to 0$
\end{itemize}
za vsako dopustno porazdelitev $P_X \in \mathcal{P}$ in vsako zaporedje $X_i
\sim P_X$ neodvisnih cenilk.

\begin{izrek}[šibki zakon velikih števil Markova]
  Naj bo $X_1, X_2, \ldots$ zaporedje nekoreliranih slučajnih spremenljivk z
  enako pričakovano vrednostjo $\mu$ in disperzijami $\sigma_i^2$, za katere je
  $\sup \sigma_i^2 < \infty$.
  Tedaj za vsak $\varepsilon > 0$ velja $\lim P(\abs{\cl{X} - \mu} >
  \varepsilon) = 0$.
\end{izrek}

\begin{proof}
  Velja
  \[
	P(\abs{\cl{X} - \mu}^2 > \varepsilon^2) \le \frac{E(\abs{\cl{X} -
		\mu}^2)}{\varepsilon^2}
	= \frac{D(\cl{X})}{\varepsilon^2}
	= \frac{\sigma_1^2 + \cdots + \sigma_n^2}{n^2 \varepsilon^2}
	\le \frac{n}{n^2 \varepsilon^2} \sup_i \sigma_i^2
  \]
  za disperzijo $D$.
  To konvergira k $0$.
\end{proof}

Naj bodo $\mathcal{P}_1, \mathcal{P}_2, \ldots$ družine dopustnih
porazdelitvenih zakonov na $B(\R), B(\R^2), \ldots$ za vektorje $X_1, (X_1,
X_2), \ldots$, ki so med seboj usklajeni; če je $P_{(X_1, \ldots, X_{n+1})} \in
\mathcal{P}_{n+1}$, je tudi $P_{(X_1, \ldots, X_n)} \in \mathcal{P}_n$.
Model je parametričen, če obstajajo usklajene bijektivne korespondence $P_n \to
\Theta$.

\begin{definicija}
  Naj bodo $e_n: \mathcal{P}_n \to \R^r$ ocenjevane funkcije in $T_n: \R^n \to
  \R^r$ Borelove preslikave.
  Zaporedje $(T_n)_n$ je za $(e_n)_n$
  \begin{itemize}
  \item \pojem{šibko dosledno}, če za vsak $\eta$
	\[
	  \lim_{n \to \infty} P(\norm{T_n(X^{(n)}) - e_n(P_n)} > \eta) = 0,
	\]
  \item \pojem{$L^2$ dosledno} ali \pojem{SKN dosledno}, če
	\[
	  \lim_{n \to \infty} E\left(\norm{T_n(X^{(n)}) - e_n(P_n)}^2\right) = 0
	\]
  \end{itemize}
  za vsako zaporedje $(P_n \in \mathcal{P}_n)_n$ in vsak vektor $X = (X_1,
  \ldots)$ z lastnostjo $P_{X^{(n)}} = P_n$ za vse $n$.
\end{definicija}

\begin{izrek}
  Naj $\lambda_{\text{min}}$ označuje najmanjšo lastno vrednost matrike.
  Če $\lambda_{\text{min}}(Z^T Z) \xrightarrow[n \to \infty]{d}
  \infty$, je zaporedje cenilk za regresijski parameter $\beta$ SKN dosledno.
\end{izrek}

\begin{trditev}
  Naj bo $T: \R^n \to \R^m$ statistika in $X$ slučajni vektor z vrednostmi v
  $\R^n$.
  Tedaj je $E(\norm{TX - E(TX)}^2) = \sled(\var TX)$.
\end{trditev}

\begin{proof}
  Račun.
  Uporabimo dejstvo $\norm{t}^2 = \sled(t t^T)$.
\end{proof}

\begin{izrek}
  Privzemimo naslednji linearni model:
  \[
	\mathcal{P}_n = \{ P_{X^{(n)}} \such X^{(n)} = Z^{(n)} \beta +
	\varepsilon^{(n)}, \var \varepsilon^{(n)} < \infty \}.
  \]
  Naj bodo $L_n \in \R^{m \times d}$ fiksne realne matrike.
  Če velja
  \begin{itemize}
  \item $\sup_n \lambda_{\text{max}}(\var \varepsilon^{(n)}) < \infty$,
  \item $\lim \lambda_{\text{max}}((Z^T Z)') = 0$,
  \item $\sup_n \max_i \norm{(L_n)_i} < \infty$,
  \item $L_n = U_n Z^{(n)}$
  \end{itemize}
  za vse $n$, je zaporedje cenilk $T_n X^{(n)} = L_n(Z^T Z)' Z^T X$ SKN-dosledno
  za $e_n(\beta, \varepsilon^{(n)}) = L_n (Z^T Z)' Z^T Z \beta$.
\end{izrek}

\begin{proof}
  Račun.
  Nujno naredi.
\end{proof}

\podnaslov{Pristranske cenilke}

Privzemimo parametrični model s prostorom parametrov $\Theta \subseteq \R^d$ in
naj bo $e: \Theta \to \R^r$ ocenjevana funkcija.
\pojem{Pristranskost} cenilke $T: \R^n \to \R^r$ za $e$ je $b_\theta(T) =
E_\theta(T(X)) - e(\theta)$.
Kvaliteto take cenilke merimo s srednjo kvadratno napako
$\operatorname{SKN}(\theta) = E_\theta(\norm{T(X) - e(\theta)}^2)$.
Velja
\begin{align*}
  \operatorname{SKN}(\theta)
  &= E_\theta(\norm{T(X) - E_\theta(T(X)) + E_\theta(T(X)) - e(\theta)}^2) \\
  &= E_\theta(\norm{T(X) - E_\theta(T(X))}^2) \\
  &+ E_\theta(\sk{T(X) - E_\theta(T(X)), E_\theta(T(X)) - e(\theta)}) \\
  &+ E_\theta(\norm{E_\theta(T(X) - e(\theta))}^2).
\end{align*}
Ker je $E_\theta(T(X) - E_\theta(T(X))) = 0$, sledi
\begin{align*}
  \operatorname{SKN}(\theta)
  &= E_\theta(\norm{T(X) - E_\theta(T(X))}^2)
  + E_\theta(\norm{E_\theta(T(X) - e(\theta))}^2) \\
  &= \sled \var_\theta(T(X)) + \norm{b_\theta(T)}^2.
\end{align*}

\begin{definicija}
  \label{stat2:def:nepristransko-v-limiti}
  Privzemimo model $(\mathcal{P}_n)_n$ za $x_1, x_2, \ldots$ in naj bo $e_n:
  \mathcal{P}_n \to \R^r$ zaporedje ocenjevanih funkcij ter $T_n: \R^n \to \R^r$
  zaporedje cenilk za $e_n$. To zaporedje je \pojem{nepristransko za $e_n$ v
	limiti}, če velja
  \[
	\lim_{n \to \infty} E_{P_n}(T_n - e_n(P_n)) = 0
  \]
  za vsako dopustno porazdelitev $(P_n)_n \in (\mathcal{P}_n)_n$.
\end{definicija}

\begin{definicija}
  Naj bo sedaj $Y_{(\mathcal{P}_n)_n}$ družina porazdelitev. Dalje naj bo
  $(a_n)_n$ zaporedje pozitivnih realnih števil in $T_n: \R^n \to \R^r$
  zaporedje statistik. Naj bo $e_n: \mathcal{P}_n \to \R^r$ zaporedje
  ocenjevanih funkcij. Če velja $\lim a_n \in \oz{0, \infty}$ in
  \[
	a_n (T_n(X^{(n)}) - e_n(P_n)) \xrightarrow[n \to \infty]{d} Y_{(P_n)_n}
  \]
  za vse $(P_n)_n \in (\mathcal{P}_n)_n$ in vsak $X$ z $X^{(n)} \sim P_n$, potem
  pravimo, da je $T_n$ \pojem{asimptotično nepristransko zaporedje cenilk} za
  $(e_n)_n$.
\end{definicija}

\begin{primer}
  Če so $T_n$ dosledne, velja $T_n(X^{(n)}) - e_n(P_n) \to 0$.
\end{primer}

\begin{primer}
  Iz CLI dobimo $\sqrt{n} (\cl{X} - \mu) \to N(0, \Sigma)$.
  V tem primeru so porazdelitve res odvisne od $(P_n)_n$ (zaradi $\Sigma$).
\end{primer}

\podnaslov{Asimptotična normalnost}

V zgornjem kontekstu (definicija~\ref{stat2:def:nepristransko-v-limiti})
pravimo, da je zaporedje $(T_n)_n$ \pojem{asimptotično normalno} zaporedje
cenilk za $(e_n)_n$, če obstaja zaporedje funkcij $V_n: \mathcal{P}_n \to
\operatorname{SPD}(r)$ (simetrične pozitivno definitne matrike $r \times r$), za
katerega velja
\[
  V_n(P_n)^{-1/2} (T_n(X^{(n)} - e_n(P_n))) \xrightarrow[n \to \infty]{d} N(0,
  I)
\]
za vsak $(P_n)_n \in (\mathcal{P}_n)_n$ in $X$ s to porazdelitvijo.

Rečemo, da je $V_n(P_n)$ \pojem{asimptotična varianca} za $T_n(X^{(n)})$.
Če je $V_n(P_n) = \inv{n} A((P_n)_n)$ za družino simetričnih pozitivno
definitnih matrik $A: (\mathcal{P}_n)_n \to \R^{r \times r}$, je to
\pojem{asimptotična varianca v ožjem smislu}.

\begin{opomba}
  Asimptotična varianca ni enolična, lahko jo npr.~pomnožimo s poljubnim
  zaporedjem, ki konvergira k $1$.
\end{opomba}

\begin{izrek}
  Privzamemo model linearne regresije $\mathcal{P}_n'$ od prej, $X = Z \beta +
  \varepsilon$.
  Privzemimo, da $\inv{v} Z^T Z$ konvergira k neki simetrični pozitivno
  definitni matriki razsežnosti $d \times d$.
  Tedaj imajo $Z^{(n)}$ poln rang za dovolj velika števila $n$ in za
  $\hat{\beta} = (Z^T Z)^{-1} Z^T X$ velja
  \[
	\inv{\sigma} (Z^T Z) (\hat{\beta} - \beta) \xrightarrow[n \to \infty]{d}
	N(0, I).
  \]
\end{izrek}

% LocalWords:  Borelova Sluckem replikacije Borelove
